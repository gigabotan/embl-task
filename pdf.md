Whole solution is here - https://github.com/gigabotan/embl-task

Sorry, I had no time to rewrite properly in pdf